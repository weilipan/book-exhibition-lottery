# 📚 書展抽獎程式

## 1️⃣ 專案簡介
本程式透過 **Google Apps Script** 開發，結合 **Google Forms、Google Sheets 和 Google Docs**，以管理書展抽獎活動。

主要功能包括：
- **📌 產生表單與試算表**
- **🎲 進行抽獎**
- **📜 顯示得獎名單**
- **🗑️ 清除中獎名單**
- **✉️ 寄送中獎名單**
- **📝 產生並寄送簽領單**

---

## 2️⃣ 使用步驟
### **🔹 產生表單與試算表**
1. **開啟 Google Sheets**，然後執行 `產生表單與試算表`。
2. 程式將自動產生 **Google Form**，並自動連結至試算表。
3. **系統將刪除其他工作表，只保留「表單回應」。**
4. **表單標題列將凍結，並新增「中獎名單」欄位。**
5. **請手動設定 Google Forms 的「檔案上傳」欄位**（上傳 PDF 或圖片）。
6. **請手動設定「僅限臺北市立建國高級中學及其信任機構的使用者」。**

### **🎲 進行抽獎**
1. 選擇 `進行抽獎`。
2. **輸入抽獎次數**（必須比目前次數大）。
3. **輸入抽獎人數**。
4. 系統將隨機選取未得獎者並更新「中獎名單」欄位。
5. 顯示抽獎結果。

### **📜 顯示得獎名單**
1. 選擇 `顯示得獎名單`。
2. **輸入要查詢的抽獎次數**。
3. 顯示該次抽獎的得獎名單。

### **🗑️ 清除中獎名單**
1. 選擇 `清除中獎名單`。
2. **輸入要清除的抽獎次數**，或輸入 `0` 來清除所有記錄。
3. 刪除指定的中獎紀錄。

### **✉️ 寄送中獎名單**
1. 選擇 `寄送中獎名單`。
2. **輸入要寄送的抽獎次數**。
3. **輸入收件人 Email**（可多個，以 `,` 分隔）。
4. 系統將寄送該次得獎名單至指定 Email。

### **📝 產生並寄送簽領單**
1. 選擇 `完成簽領單`。
2. **輸入學年度、學期、書展名稱、感謝單位、領取期間**。
3. **輸入收件人 Email**（可多個，以 `,` 分隔）。
4. 系統將產生 **Google Docs 簽領單** 並寄送連結。

---

## 3️⃣ **Google Forms 設定注意事項**
**請手動設定以下選項：**
- **✅ 限制只能由「臺北市立建國高級中學」及其信任機構的使用者填寫**。
- **✅ 啟用「收集電子郵件地址」**。
- **✅ 啟用「僅限回覆 1 次」**。
- **✅ 停用「允許使用者編輯回覆」**。
- **✅ 啟用「傳送表單回覆副本給作答者」**。
- **✅ 新增「好書推薦(封面)」檔案上傳欄位**。
  - **檔案類型：** PDF、圖片
  - **數量：** 1
  - **最大總容量：** 1GB

---

## 4️⃣ **技術細節**
### **📌 試算表欄位結構**
| 欄位名稱           | 說明                   |
|--------------------|----------------------|
| 時間戳記          | 填表時間               |
| 電子郵件地址      | 學生 Email             |
| 抽獎序號          | 學號                   |
| 所屬單位或班級    | 班級                   |
| 姓名              | 學生姓名               |
| 聯絡方式(手機)    | 手機號碼               |
| 好書推薦(ISBN)    | 書籍 ISBN              |
| 好書推薦(定價)    | 書籍價格               |
| 好書推薦(作者)    | 書籍作者               |
| 好書推薦(書名)    | 書名                   |
| 好書推薦(封面)    | 書籍封面（需手動上傳） |
| 推薦原因          | 學生推薦此書的原因     |
| 中獎名單          | 紀錄中獎次數（預設空白） |

---

## 5️⃣ **錯誤處理**
| 狀況                      | 錯誤訊息                  |
|--------------------------|--------------------------|
| 無法執行抽獎            | 可抽獎人數不足！        |
| 無法清除中獎名單        | 沒有找到對應的抽獎次數！ |
| 無法寄送 Email         | 尚未進行過抽獎！        |
| 無法產生簽領單          | 試算表中沒有中獎紀錄！  |

---

## 6️⃣ **授權與存取權限**
- **📄 Google Docs：** 設定「知道連結的使用者」可檢視，允許建立副本。
- **📧 Email：** 允許寄送 Google Docs 連結。
- **📋 Google Sheets：** 只保留「表單回應」，並自動新增「中獎名單」。

